!function(){"use strict";angular.module("app").controller("registerAndLoginCtrl",["user","userAccount","changePass","$scope","$location","currentUser",function(t,e,n,o,s,r){function a(t){t.target==c?(c.style.display="none",window.removeEventListener("click",a)):t.target==u&&(u.style.display="none",window.removeEventListener("click",a))}var i=this,c=document.getElementById("reg"),u=document.getElementById("login");i.displayReg=function(){window.addEventListener("click",a),c.style.display="block"},i.displayLogin=function(){window.addEventListener("click",a),u.style.display="block"},i.exitModal=function(){c.style.display="none",u.style.display="none",window.removeEventListener("click",a)},i.show=!1,i.phaseOneHide=!1,i.formData={},i.regForm=function(){t.save(i.formData,function(t){i.formData={},o.regForm.$setPristine()})},i.userData={},i.login=function(){i.userData.grant_type="password",i.userData.confirmPassword=i.userData.password,i.userData.userName=i.userData.email,e.loginUser(i.userData,function(t,e){r.setProfile(t.userName,!0,t.roles,t.confirm),sessionStorage.setItem("access_token",t.access_token),"Admin"==t.roles?s.path("/Admin"):(t.roles="User")?s.path("/User"):s.path("/Login")},function(t){i.errorMsg=t.statusText})},i.forgotPassword=function(){s.path("/ForgotPassword")}}]).controller("changePswCtrl",["$scope","changePass",function(t,e){var n=this;n.formData={},n.changePassword=function(){e.update(n.formData,function(e){e.Succeeded&&(n.formData={},t.changeForm.$setPristine(),n.msg="Lösenordet ändrat.")},function(t){n.errorMsg=t.statusText})}}]).controller("forgotPassCtrl",["$scope","fp",function(t,e){var n=this;n.formData={},n.msg="",n.validMsg=!1,n.send=function(){e.get(n.formData,function(e){n.msg="Länken är nu skickad till den angivna eposten.",n.validMsg=!0,n.formData={},t.forgotForm.$setPristine()},function(t){n.errorMsg=t.statusText})}}]).controller("recoverPassCtrl",["rp","$routeParams","$location",function(t,e,n){var o=this;o.formData={ID:e.userId,Code:e.code,Email:"",Password:"",ConfirmPassword:""},o.confirmNewPass=function(){t.post(o.formData,function(t){n.path("/Login")},function(t){o.errorMsg=t.statusText})}}]).controller("confirmMailCtrl",["cm","$routeParams",function(t,e){var n=this;t.get({userId:e.userId,code:e.code},function(t){"C"==t[0]?n.cmMsg="Tack, Du har nu bekräftat din epost.":n.cmMsg="Något gick fel, försök igen."},function(t){n.errorMsg=t.statusText})}])}();