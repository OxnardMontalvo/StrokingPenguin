!function(){"use strict";angular.module("app",["ngRoute","services","oc.lazyLoad"]).config(["$routeProvider","$qProvider",function(e,r){e.when("/",{templateUrl:"App/html/startPage.html",controller:"registerAndLoginCtrl",controllerAs:"vm"}).when("/Login",{templateUrl:"App/html/startPage.html",controller:"registerAndLoginCtrl",controllerAs:"vm"}).when("/Admin",{templateUrl:"App/html/adminPage.html",controller:"adminCtrl",controllerAs:"vm",resolve:{checkRoleValidation:["checkRole","$location",function(e,r){if(0!=e.getARole().$$state.value)return!0;r.path("/Login")}],loadMyCtrl:["$ocLazyLoad",function(e){return e.load("App/js/adminController.js")}]}}).when("/AdminCreate",{templateUrl:"App/html/adminCreate.html",controller:"adminCreateCtrl",controllerAs:"vm",resolve:{checkRoleValidation:["checkRole","$location",function(e,r){if(0!=e.getARole().$$state.value)return!0;r.path("/Login")}]}}).when("/ForgotPassword",{templateUrl:"App/html/forgotPasswordPage.html",controller:"forgotPassCtrl",controllerAs:"vm"}).when("/RecoverPassword/:userId/:code",{templateUrl:"App/html/restorePasswordPage.html",controller:"recoverPassCtrl",controllerAs:"vm"}).when("/ChangePassword",{templateUrl:"App/html/changePasswordPage.html",controller:"changePswCtrl",controllerAs:"vm",resolve:{checkRoleValidation:["checkRole","$location",function(e,r){if(0!=e.getAURole().$$state.value)return!0;r.path("/Login")}]}}).when("/ConfirmEmail/:userId/:code",{templateUrl:"App/html/confirmMail.html",controller:"confirmMailCtrl",controllerAs:"vm"}).when("/User",{templateUrl:"App/html/userPage.html",controller:"userCtrl",controllerAs:"vm",resolve:{checkRoleValidation:["checkRole","$location",function(e,r){if(0!=e.getAURole().$$state.value)return!0;r.path("/Login")}],loadMyCtrl:["$ocLazyLoad",function(e){return e.load("App/js/userCtrl.js")}]}}).otherwise({redirectTo:"/"})}]).factory("checkRole",["$q","currentUser",function(e,r){return{getARole:function(){var o=e.defer();return null!=r.getProfile()&&r.getProfile().isLoggedIn&&"Admin"===r.getProfile().role?(o.resolve(!0),o.promise):(o.resolve(!1),o.promise)},getAURole:function(){var o=e.defer();return null==r.getProfile()||!r.getProfile().isLoggedIn||"Admin"!==r.getProfile().role&&"User"!==r.getProfile().role?(o.resolve(!1),o.promise):(o.resolve(!0),o.promise)}}}]).factory("currentUser",function(){var e={isLoggedIn:!1,username:"",role:""};return{setProfile:function(r,o,t){e.username=r,e.isLoggedIn=o,e.role=t,sessionStorage.setItem("profile",JSON.stringify(e))},getProfile:function(){return JSON.parse(sessionStorage.getItem("profile"))}}}).controller("userInfo",["currentUser","$scope","$location",function(e,r,o){r.displayLogOut=!1,r.$watch(function(){if(null!=e.getProfile())return e.getProfile().username},function(e,o){null!=e&&(r.cUser=e,r.displayLogOut=!0)}),r.$watch(function(){if(null!=e.getProfile())return e.getProfile().role},function(e,o){null!=e&&(r.currentRole=e)}),r.logOut=function(){sessionStorage.clear(),r.cUser="",r.displayLogOut=!1,o.path("/")},r.changePass=function(){o.path("/ChangePassword")}}])}();