!function(){"use strict";angular.module("app").controller("adminCtrl",["user","userPage","currentUser","searchUser",function(e,r,s,t){function a(e){r.query({take:e,page:u+1},function(e){e.length>0?n.displayLoadMore=!0:n.displayLoadMore=!1},function(e){n.errorMsg=e.statusText})}var n=this;n.users=[],n.take=25;var u=1,i=!0;n.hasSearch=!1,n.errorMsg="",n.btnText="Ladda fler",n.disableDuringLoad=!0,n.firstUsers=function(e){u=1,n.disableDuringLoad=!0,n.btnText="Laddar...",r.query({take:e,page:u},function(e){angular.copy(e,n.users),n.disableDuringLoad=!1,n.btnText="Ladda fler"},function(e){console.log(e),n.errorMsg=e.statusText}),a(e)},n.firstUsers(n.take),n.loadMoreUsers=function(e){n.hasSearch?(n.firstUsers(e),n.hasSearch=!1):(n.isRefreshed||n.refreshUserList(),u+=1,n.disableDuringLoad=!0,n.btnText="Laddar...",r.query({take:e,page:u},function(e){for(var r=0;r<e.length;r++)n.users.push(e[r]),n.btnText="Ladda fler",n.disableDuringLoad=!1},function(e){n.errorMsg=e.statusText}),a(e))},n.selectUser=function(e){for(var r=0;r<n.users.length;r++)n.users[r].Id==e&&(n.selUser=n.users[r])},n.cancleUserEdit=function(){n.selUser=""},n.saveUserEdit=function(r){e.update({id:r},n.selUser,function(e){i=!1,n.disableDuringLoad=!1},function(e){n.errorMsg=e.statusText}),n.selUser=""},n.deleteUser=function(r){confirm("Vill du verkligen ta bort personen frÃ¥n Databasen?")&&e.delete({id:r},function(e){for(var s,t=0;t<n.users.length;t++)n.users[t].Id==r&&(s=t);n.users.splice(s,1)},function(e){n.errorMsg=e.statusText})},n.refreshUserList=function(){i=!0,n.disableDuringLoad=!0,n.btnText="Ladda fler",n.hasSearch=!1,n.users=[];for(var e=1;e<u+1;e++)n.btnText="Laddar...",r.query({take:n.take,page:e},function(e){for(var r=0;r<e.length;r++)n.users.push(e[r]),n.btnText="Ladda fler",n.disableDuringLoad=!1;n.users.sort(function(e,r){return e.DistrictNumber-r.DistrictNumber})},function(e){n.errorMsg=e.statusText})},n.searchUser=function(e){n.displayLoadMore=!1,n.disableDuringLoad=!0,n.hasSearch=!0,n.users=[],n.btnText="Laddar...",t.stringSearch.query({query:e},function(e){angular.copy(e,n.users),n.disableDuringLoad=!1},function(e){n.errorMsg=e.statusText})},n.searchDistrict=function(e){n.displayLoadMore=!1,n.disableDuringLoad=!0,n.hasSearch=!0,n.users=[],n.btnText="Laddar...",t.districtSearch.query({query:e},function(e){angular.copy(e,n.users),n.disableDuringLoad=!1},function(e){n.errorMsg=e.statusText})}}])}();